---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Read in the zip file
```{r readdata, echo=TRUE}
# Assume the data is in current working directory in a file named "activity.zip" 
activityData <- read.csv(unz("activity.zip", "activity.csv"))
```

Clean up and extend our data
```{r cleandata, echo=TRUE}
# the interval seems to be in 24 hour time 00:00 -> 23:55
# Add and extra column "time" that will convert date and interval into a
# POXIXct object for later data calulations
activityData$time <- strptime(sprintf("%s %04d", 
                                      activityData$date, 
                                      activityData$interval), 
                              format = "%F %H%M", 
                              tz = "GMT")
```

## What is mean total number of steps taken per day?
```{r stepshistogram, echo=TRUE}
stepsPerDay<-tapply(activityData$steps,activityData$date,FUN=sum)
hist(stepsPerDay,breaks=10, main="Steps per Day",xlab="steps")
```

```{r stepsmeanmedian, echo=TRUE}
# Remove the NAs while calculating the mean and median
stepsMM <- c(mean(stepsPerDay,na.rm=TRUE),median(stepsPerDay,na.rm=TRUE))
stepsMM <- setNames (stepsMM,c("Mean","Median"))
stepsMM
```


## What is the average daily activity pattern?

Average steps per interval
```{r averagedailyactivity, echo=TRUE}

# Calulate our averages over intervals ignoring NAs
avgDailyActivity <- tapply( activityData$steps,
                            activityData$interval,
                            FUN=mean,
                            na.rm=TRUE )
# Tidy our row names to make the plot easier to read 
# Intervals should look like 24hr time: 00:00 thru 23:55
rownames(avgDailyActivity) <- sub('(?<=.{2})', 
                                  ':', 
                                  sprintf("%04d",as.integer(rownames(avgDailyActivity))), 
                                  perl=TRUE)
# Convert to a data frame for plotting
temp <- data.frame(interval=rownames(avgDailyActivity),average=avgDailyActivity)
#plot(average ~ interval,data = temp, type = "l")
plot(temp, 
     type="l", 
    main="Average Daily Activity Pattern", 
    xlab ="Interval", 
     ylab="Average Steps per Interval")

```

Interval with the maximum number of steps (on average)
```{r maxavgsteps, echo=TRUE}
print (temp[which.max(temp$average),],row.names=FALSE)

```

## Imputing missing values

Find the number of NAs
```{r countna, echo=TRUE}
sum(is.na(activityData$steps))
```

Imput the values for the NAs
```{r imputevalues, echo=TRUE}
newActivityData <- activityData
newActivityData[is.na(newActivityData$steps),]$steps <- round(tapply(X=newActivityData$steps,INDEX=newActivityData$interval,FUN=mean,na.rm=TRUE))
```

Create a histogram of the the new data calculate the mean and median
```{r newstepshistogram, echo=TRUE}
newStepsPerDay<-tapply(activityData$steps,activityData$date,FUN=sum)
hist(newStepsPerDay,breaks=10, main="Steps per Day",xlab="steps")
```

```{r newstepsmeanmedian, echo=TRUE}
# Remove the NAs while calculating the mean and median
newStepsMM <- c(mean(newStepsPerDay,na.rm=TRUE),median(newStepsPerDay,na.rm=TRUE))
newStepsMM <- setNames (newStepsMM,c("Mean","Median"))
newStepsMM
```
## Are there differences in activity patterns between weekdays and weekends?

Create a weekday/weekend factor
Average number of steps taken, averaged across all weekday days or weekend days
